var commandChar=";",GunnerBot;!function(n){var t;!function(n){function t(){for(var n=[],t=0;t<arguments.length;t++)n[t-0]=arguments[t];console.log(n.join(" "))}n.log=t}(t=n.Utilities||(n.Utilities={}))}(GunnerBot||(GunnerBot={}));var net=require("net"),GunnerBot;!function(n){var t;!function(t){var e=function(){function t(){this.socket=new net.Socket,this.listeners=[],this.socket.setEncoding("ascii"),this.socket.setNoDelay(),this.startupConfig()}return t.prototype.startupConfig=function(){var t=this;this.addListener("PingPong",/^PING :(.+)$/i,function(n){t.send("PONG :"+n[1])}),this.addListener("JoinChannel",new RegExp(" PRIVMSG (.*) :"+commandChar+"Join (.*)","i"),function(n){irc.send("JOIN "+n[2])}),this.socket.on("data",function(e){e=e.split("\r\n"),e.forEach(function(e){n.Utilities.log("RECV -",e),""!==e&&t.handle(e)})})},t.prototype.connect=function(t,e,i,o){var s=this;this.socket.on("connect",function(){n.Utilities.log("Established connection, registering and shit..."),setTimeout(function(){s.send("NICK "+o),s.send("USER "+o+" 8 *:Node.js IRC bot"),i&&setTimeout(function(){s.join(i)},3e3)},1e3)}),this.socket.connect(e,t)},t.prototype.join=function(t){this.send("JOIN "+t),n.Utilities.log("JOINED CHANNEL -",t)},t.prototype.addListener=function(n,t,e){this.listeners.push([n,t,e])},t.prototype.removeListener=function(n){for(var t=0;t<this.listeners.length;t++)this.listeners[t][0]===n&&(this.listeners.splice(t,1),t--)},t.prototype.handle=function(n){for(var t=0;t<this.listeners.length;t++){var e=this.listeners[t][1].exec(n);e&&this.listeners[t][2](e)}},t.prototype.send=function(t){this.socket.write(t+"\r\n","ascii",function(){n.Utilities.log("SENT -",t)})},t.prototype.say=function(n,t){0==t.indexOf("ACTION ")&&(t=String.fromCharCode(1)+t+String.fromCharCode(1)),this.socket.write("PRIVMSG "+n+" :"+t+"\r\n","ascii",function(){console.log("SAID ("+n+") -",t)})},t}();t.IRC=e}(t=n.IRC||(n.IRC={}))}(GunnerBot||(GunnerBot={}));var utilities=GunnerBot.Utilities,ircModule=GunnerBot.IRC,irc=new ircModule.IRC,MarkovChain=require("markovchain"),fs=require("fs"),DBRecords=new MarkovChain(fs.readFileSync("./DBRecords.txt")),args=process.argv.slice(2),server=args.shift(),channel=args.shift();irc.addListener("Echo",new RegExp(" PRIVMSG (.*) :"+commandChar+"Echo (.*)","i"),function(n){irc.say(n[1],n[2])}),irc.addListener("DBX",new RegExp(" PRIVMSG (.*) :"+commandChar+"DBX ?$","i"),function(n){var t=Math.floor(160*Math.random())+":"+("0"+Math.floor(60*Math.random())).slice(-2)+" - ";t+=1==Math.floor(100*Math.random())?"Johnny's shift ends, Johnny's shift begins.":DBRecords.start(function(n){var t=Object.keys(n);return t[~~(Math.random()*t.length)]}).end().process(),irc.say(n[1],t)}),irc.connect(server,6667,channel,"GunnerBot"),setTimeout(function(){args.forEach(function(n){irc.join(n)})},5e3);